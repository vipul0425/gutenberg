"use strict";(self.webpackChunkgutenberg=self.webpackChunkgutenberg||[]).push([[951],{"./packages/block-editor/src/components/block-draggable/draggable-chip.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return BlockDraggableChip}});__webpack_require__("./node_modules/react/index.js");var _wordpress_i18n__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/i18n/build-module/index.js"),_wordpress_components__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/components/build-module/flex/flex/component.js"),_wordpress_components__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/components/build-module/flex/flex-item/component.js"),_wordpress_icons__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./packages/icons/build-module/library/drag-handle.js"),_block_icon__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/block-editor/src/components/block-icon/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");function BlockDraggableChip({count:count,icon:icon,isPattern:isPattern,fadeWhenDisabled:fadeWhenDisabled}){const patternLabel=isPattern&&(0,_wordpress_i18n__WEBPACK_IMPORTED_MODULE_1__.__)("Pattern");return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{className:"block-editor-block-draggable-chip-wrapper",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{className:"block-editor-block-draggable-chip","data-testid":"block-draggable-chip",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_wordpress_components__WEBPACK_IMPORTED_MODULE_3__.Z,{justify:"center",className:"block-editor-block-draggable-chip__content",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_wordpress_components__WEBPACK_IMPORTED_MODULE_4__.Z,{children:icon?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_block_icon__WEBPACK_IMPORTED_MODULE_5__.Z,{icon:icon}):patternLabel||(0,_wordpress_i18n__WEBPACK_IMPORTED_MODULE_1__.gB)((0,_wordpress_i18n__WEBPACK_IMPORTED_MODULE_1__._n)("%d block","%d blocks",count),count)}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_wordpress_components__WEBPACK_IMPORTED_MODULE_4__.Z,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_block_icon__WEBPACK_IMPORTED_MODULE_5__.Z,{icon:_wordpress_icons__WEBPACK_IMPORTED_MODULE_6__.Z})}),fadeWhenDisabled&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_wordpress_components__WEBPACK_IMPORTED_MODULE_4__.Z,{className:"block-editor-block-draggable-chip__disabled",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("span",{className:"block-editor-block-draggable-chip__disabled-icon"})})]})})})}BlockDraggableChip.displayName="BlockDraggableChip",BlockDraggableChip.__docgenInfo={description:"",methods:[],displayName:"BlockDraggableChip"}},"./packages/block-editor/src/components/block-icon/index.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_1__),_wordpress_components__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./packages/components/build-module/icon/index.js"),_wordpress_icons__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/icons/build-module/library/block-default.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");function BlockIcon({icon:icon,showColors:showColors=!1,className:className,context:context}){"block-default"===icon?.src&&(icon={src:_wordpress_icons__WEBPACK_IMPORTED_MODULE_3__.Z});const renderedIcon=(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_wordpress_components__WEBPACK_IMPORTED_MODULE_4__.Z,{icon:icon&&icon.src?icon.src:icon,context:context}),style=showColors?{backgroundColor:icon&&icon.background,color:icon&&icon.foreground}:{};return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("span",{style:style,className:classnames__WEBPACK_IMPORTED_MODULE_1___default()("block-editor-block-icon",className,{"has-colors":showColors}),children:renderedIcon})}BlockIcon.displayName="BlockIcon",BlockIcon.__docgenInfo={description:"",methods:[],displayName:"BlockIcon",props:{showColors:{defaultValue:{value:"false",computed:!1},required:!1}}},__webpack_exports__.Z=(0,react__WEBPACK_IMPORTED_MODULE_0__.memo)(BlockIcon)},"./packages/block-editor/src/components/block-list/use-block-props/use-block-refs.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{LT:function(){return useBlockRefProvider},qT:function(){return useBlockElement},tI:function(){return useBlockRef}});var _wordpress_element__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_wordpress_compose__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/compose/build-module/hooks/use-ref-effect/index.js"),_provider_block_refs_provider__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/block-editor/src/components/provider/block-refs-provider.js");function useBlockRefProvider(clientId){const{refs:refs,callbacks:callbacks}=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_0__.useContext)(_provider_block_refs_provider__WEBPACK_IMPORTED_MODULE_1__.N),ref=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_0__.useRef)();return(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)((()=>(refs.set(ref,clientId),()=>{refs.delete(ref)})),[clientId]),(0,_wordpress_compose__WEBPACK_IMPORTED_MODULE_2__.Z)((element=>{ref.current=element,callbacks.forEach(((id,setElement)=>{clientId===id&&setElement(element)}))}),[clientId])}function useBlockRef(clientId){const{refs:refs}=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_0__.useContext)(_provider_block_refs_provider__WEBPACK_IMPORTED_MODULE_1__.N),freshClientId=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_0__.useRef)();return freshClientId.current=clientId,(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>({get current(){let element=null;for(const[ref,id]of refs.entries())id===freshClientId.current&&ref.current&&(element=ref.current);return element}})),[])}function useBlockElement(clientId){const{callbacks:callbacks}=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_0__.useContext)(_provider_block_refs_provider__WEBPACK_IMPORTED_MODULE_1__.N),ref=useBlockRef(clientId),[element,setElement]=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_0__.useState)(null);return(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)((()=>{if(clientId)return callbacks.set(setElement,clientId),()=>{callbacks.delete(setElement)}}),[clientId]),ref.current||element}},"./packages/block-editor/src/components/provider/block-refs-provider.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{N:function(){return BlockRefs},m:function(){return BlockRefsProvider}});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");const BlockRefs=(0,react__WEBPACK_IMPORTED_MODULE_0__.createContext)({refs:new Map,callbacks:new Map});function BlockRefsProvider({children:children}){const value=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>({refs:new Map,callbacks:new Map})),[]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(BlockRefs.Provider,{value:value,children:children})}BlockRefsProvider.displayName="BlockRefsProvider",BlockRefsProvider.__docgenInfo={description:"",methods:[],displayName:"BlockRefsProvider"}},"./packages/block-editor/src/components/provider/index.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{jC:function(){return ExperimentalBlockEditorProvider}});var react=__webpack_require__("./node_modules/react/index.js"),use_dispatch=__webpack_require__("./packages/data/build-module/components/use-dispatch/use-dispatch.js"),slot_fill=__webpack_require__("./packages/components/build-module/slot-fill/index.js"),with_registry=__webpack_require__("./packages/data/build-module/components/with-registry/index.js"),build_module_registry=__webpack_require__("./packages/data/build-module/registry.js"),context=__webpack_require__("./packages/data/build-module/components/registry-provider/context.js"),create_higher_order_component=__webpack_require__("./packages/compose/build-module/utils/create-higher-order-component/index.js"),store=__webpack_require__("./packages/block-editor/src/store/index.js"),constants=__webpack_require__("./packages/block-editor/src/store/constants.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");var with_registry_provider=(0,create_higher_order_component.o)((WrappedComponent=>(0,with_registry.Z)((({useSubRegistry:useSubRegistry=!0,registry:registry,...props})=>{if(!useSubRegistry)return(0,jsx_runtime.jsx)(WrappedComponent,{registry:registry,...props});const[subRegistry,setSubRegistry]=(0,react.useState)(null);return(0,react.useEffect)((()=>{const newRegistry=(0,build_module_registry.p)({},registry);newRegistry.registerStore(constants.G,store.i),setSubRegistry(newRegistry)}),[registry]),subRegistry?(0,jsx_runtime.jsx)(context.ZP,{value:subRegistry,children:(0,jsx_runtime.jsx)(WrappedComponent,{registry:subRegistry,...props})}):null}))),"withRegistryProvider"),use_block_sync=__webpack_require__("./packages/block-editor/src/components/provider/use-block-sync.js"),block_refs_provider=__webpack_require__("./packages/block-editor/src/components/provider/block-refs-provider.js"),lock_unlock=__webpack_require__("./packages/block-editor/src/lock-unlock.js"),build_module=__webpack_require__("./packages/keyboard-shortcuts/build-module/index.js"),i18n_build_module=__webpack_require__("./packages/i18n/build-module/index.js");function KeyboardShortcuts(){return null}KeyboardShortcuts.Register=function KeyboardShortcutsRegister(){const{registerShortcut:registerShortcut}=(0,use_dispatch.Z)(build_module.h);return(0,react.useEffect)((()=>{registerShortcut({name:"core/block-editor/duplicate",category:"block",description:(0,i18n_build_module.__)("Duplicate the selected block(s)."),keyCombination:{modifier:"primaryShift",character:"d"}}),registerShortcut({name:"core/block-editor/remove",category:"block",description:(0,i18n_build_module.__)("Remove the selected block(s)."),keyCombination:{modifier:"access",character:"z"}}),registerShortcut({name:"core/block-editor/insert-before",category:"block",description:(0,i18n_build_module.__)("Insert a new block before the selected block(s)."),keyCombination:{modifier:"primaryAlt",character:"t"}}),registerShortcut({name:"core/block-editor/insert-after",category:"block",description:(0,i18n_build_module.__)("Insert a new block after the selected block(s)."),keyCombination:{modifier:"primaryAlt",character:"y"}}),registerShortcut({name:"core/block-editor/delete-multi-selection",category:"block",description:(0,i18n_build_module.__)("Delete selection."),keyCombination:{character:"del"},aliases:[{character:"backspace"}]}),registerShortcut({name:"core/block-editor/select-all",category:"selection",description:(0,i18n_build_module.__)("Select all text when typing. Press again to select all blocks."),keyCombination:{modifier:"primary",character:"a"}}),registerShortcut({name:"core/block-editor/unselect",category:"selection",description:(0,i18n_build_module.__)("Clear selection."),keyCombination:{character:"escape"}}),registerShortcut({name:"core/block-editor/multi-text-selection",category:"selection",description:(0,i18n_build_module.__)("Select text across multiple blocks."),keyCombination:{modifier:"shift",character:"arrow"}}),registerShortcut({name:"core/block-editor/focus-toolbar",category:"global",description:(0,i18n_build_module.__)("Navigate to the nearest toolbar."),keyCombination:{modifier:"alt",character:"F10"}}),registerShortcut({name:"core/block-editor/move-up",category:"block",description:(0,i18n_build_module.__)("Move the selected block(s) up."),keyCombination:{modifier:"secondary",character:"t"}}),registerShortcut({name:"core/block-editor/move-down",category:"block",description:(0,i18n_build_module.__)("Move the selected block(s) down."),keyCombination:{modifier:"secondary",character:"y"}})}),[registerShortcut]),null};var keyboard_shortcuts=KeyboardShortcuts;const ExperimentalBlockEditorProvider=with_registry_provider((props=>{const{children:children,settings:settings,stripExperimentalSettings:stripExperimentalSettings=!1}=props,{__experimentalUpdateSettings:__experimentalUpdateSettings}=(0,lock_unlock.U)((0,use_dispatch.Z)(store.h));return(0,react.useEffect)((()=>{__experimentalUpdateSettings({...settings,__internalIsInitialized:!0},{stripExperimentalSettings:stripExperimentalSettings,reset:!0})}),[settings,stripExperimentalSettings,__experimentalUpdateSettings]),(0,use_block_sync.Z)(props),(0,jsx_runtime.jsxs)(slot_fill.zt,{passthrough:!0,children:[(0,jsx_runtime.jsx)(keyboard_shortcuts.Register,{}),(0,jsx_runtime.jsx)(block_refs_provider.m,{children:children})]})})),BlockEditorProvider=props=>(0,jsx_runtime.jsx)(ExperimentalBlockEditorProvider,{...props,stripExperimentalSettings:!0,children:props.children});BlockEditorProvider.displayName="BlockEditorProvider",BlockEditorProvider.__docgenInfo={description:"",methods:[],displayName:"BlockEditorProvider"}},"./packages/block-editor/src/components/provider/use-block-sync.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return useBlockSync}});var _wordpress_element__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/index.js"),_wordpress_data__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/data/build-module/components/registry-provider/use-registry.js"),_wordpress_data__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./packages/data/build-module/components/use-select/index.js"),_wordpress_blocks__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/blocks/build-module/index.js"),_store__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/block-editor/src/store/index.js"),_store_undo_ignore__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/block-editor/src/store/undo-ignore.js");const noop=()=>{};function useBlockSync({clientId:clientId=null,value:controlledBlocks,selection:controlledSelection,onChange:onChange=noop,onInput:onInput=noop}){const registry=(0,_wordpress_data__WEBPACK_IMPORTED_MODULE_2__.Z)(),{resetBlocks:resetBlocks,resetSelection:resetSelection,replaceInnerBlocks:replaceInnerBlocks,setHasControlledInnerBlocks:setHasControlledInnerBlocks,__unstableMarkNextChangeAsNotPersistent:__unstableMarkNextChangeAsNotPersistent}=registry.dispatch(_store__WEBPACK_IMPORTED_MODULE_1__.h),{getBlockName:getBlockName,getBlocks:getBlocks,getSelectionStart:getSelectionStart,getSelectionEnd:getSelectionEnd}=registry.select(_store__WEBPACK_IMPORTED_MODULE_1__.h),isControlled=(0,_wordpress_data__WEBPACK_IMPORTED_MODULE_3__.Z)((select=>!clientId||select(_store__WEBPACK_IMPORTED_MODULE_1__.h).areInnerBlocksControlled(clientId)),[clientId]),pendingChanges=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_4__.useRef)({incoming:null,outgoing:[]}),subscribed=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_4__.useRef)(!1),setControlledBlocks=()=>{controlledBlocks&&(__unstableMarkNextChangeAsNotPersistent(),clientId?registry.batch((()=>{setHasControlledInnerBlocks(clientId,!0);const storeBlocks=controlledBlocks.map((block=>(0,_wordpress_blocks__WEBPACK_IMPORTED_MODULE_0__.Wm)(block)));subscribed.current&&(pendingChanges.current.incoming=storeBlocks),__unstableMarkNextChangeAsNotPersistent(),replaceInnerBlocks(clientId,storeBlocks)})):(subscribed.current&&(pendingChanges.current.incoming=controlledBlocks),resetBlocks(controlledBlocks)))},onInputRef=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_4__.useRef)(onInput),onChangeRef=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_4__.useRef)(onChange);(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_4__.useEffect)((()=>{onInputRef.current=onInput,onChangeRef.current=onChange}),[onInput,onChange]),(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_4__.useEffect)((()=>{pendingChanges.current.outgoing.includes(controlledBlocks)?pendingChanges.current.outgoing[pendingChanges.current.outgoing.length-1]===controlledBlocks&&(pendingChanges.current.outgoing=[]):getBlocks(clientId)!==controlledBlocks&&(pendingChanges.current.outgoing=[],setControlledBlocks(),controlledSelection&&resetSelection(controlledSelection.selectionStart,controlledSelection.selectionEnd,controlledSelection.initialPosition))}),[controlledBlocks,clientId]),(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_4__.useEffect)((()=>{isControlled||(pendingChanges.current.outgoing=[],setControlledBlocks())}),[isControlled]),(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_4__.useEffect)((()=>{const{getSelectedBlocksInitialCaretPosition:getSelectedBlocksInitialCaretPosition,isLastBlockChangePersistent:isLastBlockChangePersistent,__unstableIsLastBlockChangeIgnored:__unstableIsLastBlockChangeIgnored,areInnerBlocksControlled:areInnerBlocksControlled}=registry.select(_store__WEBPACK_IMPORTED_MODULE_1__.h);let blocks=getBlocks(clientId),isPersistent=isLastBlockChangePersistent(),previousAreBlocksDifferent=!1;subscribed.current=!0;const unsubscribe=registry.subscribe((()=>{if(null!==clientId&&null===getBlockName(clientId))return;if(!(!clientId||areInnerBlocksControlled(clientId)))return;const newIsPersistent=isLastBlockChangePersistent(),newBlocks=getBlocks(clientId),areBlocksDifferent=newBlocks!==blocks;if(blocks=newBlocks,areBlocksDifferent&&(pendingChanges.current.incoming||__unstableIsLastBlockChangeIgnored()))return pendingChanges.current.incoming=null,void(isPersistent=newIsPersistent);if(areBlocksDifferent||previousAreBlocksDifferent&&!areBlocksDifferent&&newIsPersistent&&!isPersistent){isPersistent=newIsPersistent,pendingChanges.current.outgoing.push(blocks);const updateParent=isPersistent?onChangeRef.current:onInputRef.current,undoIgnore=_store_undo_ignore__WEBPACK_IMPORTED_MODULE_5__.t.has(blocks);undoIgnore&&_store_undo_ignore__WEBPACK_IMPORTED_MODULE_5__.t.delete(blocks),updateParent(blocks,{selection:{selectionStart:getSelectionStart(),selectionEnd:getSelectionEnd(),initialPosition:getSelectedBlocksInitialCaretPosition()},undoIgnore:undoIgnore})}previousAreBlocksDifferent=areBlocksDifferent}),_store__WEBPACK_IMPORTED_MODULE_1__.h);return()=>{subscribed.current=!1,unsubscribe()}}),[registry,clientId]),(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_4__.useEffect)((()=>()=>{__unstableMarkNextChangeAsNotPersistent(),clientId?(setHasControlledInnerBlocks(clientId,!1),__unstableMarkNextChangeAsNotPersistent(),replaceInnerBlocks(clientId,[])):resetBlocks([])}),[])}},"./packages/block-editor/src/components/use-block-drop-zone/index.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{ZP:function(){return useBlockDropZone},wv:function(){return isDropTargetValid}});var use_registry=__webpack_require__("./packages/data/build-module/components/registry-provider/use-registry.js"),use_select=__webpack_require__("./packages/data/build-module/components/use-select/index.js"),use_dispatch=__webpack_require__("./packages/data/build-module/components/use-dispatch/use-dispatch.js"),react=__webpack_require__("./node_modules/react/index.js"),use_throttle=__webpack_require__("./packages/compose/build-module/hooks/use-throttle/index.js"),use_drop_zone=__webpack_require__("./packages/compose/build-module/hooks/use-drop-zone/index.js"),build_module=__webpack_require__("./packages/i18n/build-module/index.js"),blocks_build_module=__webpack_require__("./packages/blocks/build-module/index.js"),data_transfer=__webpack_require__("./packages/dom/build-module/data-transfer.js"),store=__webpack_require__("./packages/block-editor/src/store/index.js");function onBlockDrop(targetRootClientId,targetBlockIndex,getBlockIndex,getClientIdsOfDescendants,moveBlocks,insertOrReplaceBlocks,clearSelectedBlock){return event=>{const{srcRootClientId:sourceRootClientId,srcClientIds:sourceClientIds,type:dropType,blocks:blocks}=function parseDropEvent(event){let result={srcRootClientId:null,srcClientIds:null,srcIndex:null,type:null,blocks:null};if(!event.dataTransfer)return result;try{result=Object.assign(result,JSON.parse(event.dataTransfer.getData("wp-blocks")))}catch(err){return result}return result}(event);if("inserter"===dropType){clearSelectedBlock();const blocksToInsert=blocks.map((block=>(0,blocks_build_module.Wm)(block)));insertOrReplaceBlocks(blocksToInsert,!0,null)}if("block"===dropType){const sourceBlockIndex=getBlockIndex(sourceClientIds[0]);if(sourceRootClientId===targetRootClientId&&sourceBlockIndex===targetBlockIndex)return;if(sourceClientIds.includes(targetRootClientId)||getClientIdsOfDescendants(sourceClientIds).some((id=>id===targetRootClientId)))return;const isAtSameLevel=sourceRootClientId===targetRootClientId,draggedBlockCount=sourceClientIds.length;moveBlocks(sourceClientIds,sourceRootClientId,isAtSameLevel&&sourceBlockIndex<targetBlockIndex?targetBlockIndex-draggedBlockCount:targetBlockIndex)}}}function useOnBlockDrop(targetRootClientId,targetBlockIndex,options={}){const{operation:operation="insert"}=options,{canInsertBlockType:canInsertBlockType,getBlockIndex:getBlockIndex,getClientIdsOfDescendants:getClientIdsOfDescendants,getBlockOrder:getBlockOrder,getBlocksByClientId:getBlocksByClientId,getSettings:getSettings}=(0,use_select.Z)(store.h),{insertBlocks:insertBlocks,moveBlocksToPosition:moveBlocksToPosition,updateBlockAttributes:updateBlockAttributes,clearSelectedBlock:clearSelectedBlock,replaceBlocks:replaceBlocks,removeBlocks:removeBlocks}=(0,use_dispatch.Z)(store.h),registry=(0,use_registry.Z)(),insertOrReplaceBlocks=(0,react.useCallback)(((blocks,updateSelection=!0,initialPosition=0)=>{if("replace"===operation){const clientId=getBlockOrder(targetRootClientId)[targetBlockIndex];replaceBlocks(clientId,blocks,void 0,initialPosition)}else insertBlocks(blocks,targetBlockIndex,targetRootClientId,updateSelection,initialPosition)}),[operation,getBlockOrder,insertBlocks,replaceBlocks,targetBlockIndex,targetRootClientId]),moveBlocks=(0,react.useCallback)(((sourceClientIds,sourceRootClientId,insertIndex)=>{if("replace"===operation){const sourceBlocks=getBlocksByClientId(sourceClientIds),targetBlockClientId=getBlockOrder(targetRootClientId)[targetBlockIndex];registry.batch((()=>{removeBlocks(sourceClientIds,!1),replaceBlocks(targetBlockClientId,sourceBlocks,void 0,0)}))}else moveBlocksToPosition(sourceClientIds,sourceRootClientId,targetRootClientId,insertIndex)}),[operation,getBlockOrder,getBlocksByClientId,moveBlocksToPosition,registry,removeBlocks,replaceBlocks,targetBlockIndex,targetRootClientId]),_onDrop=onBlockDrop(targetRootClientId,targetBlockIndex,getBlockIndex,getClientIdsOfDescendants,moveBlocks,insertOrReplaceBlocks,clearSelectedBlock),_onFilesDrop=function onFilesDrop(targetRootClientId,targetBlockIndex,getSettings,updateBlockAttributes,canInsertBlockType,insertOrReplaceBlocks){return files=>{if(!getSettings().mediaUpload)return;const transformation=(0,blocks_build_module.MC)((0,blocks_build_module.Xn)("from"),(transform=>"files"===transform.type&&canInsertBlockType(transform.blockName,targetRootClientId)&&transform.isMatch(files)));if(transformation){const blocks=transformation.transform(files,updateBlockAttributes);insertOrReplaceBlocks(blocks)}}}(targetRootClientId,0,getSettings,updateBlockAttributes,canInsertBlockType,insertOrReplaceBlocks),_onHTMLDrop=function onHTMLDrop(targetRootClientId,targetBlockIndex,insertOrReplaceBlocks){return HTML=>{const blocks=(0,blocks_build_module.ag)({HTML:HTML,mode:"BLOCKS"});blocks.length&&insertOrReplaceBlocks(blocks)}}(0,0,insertOrReplaceBlocks);return event=>{const files=(0,data_transfer.f)(event.dataTransfer),html=event.dataTransfer.getData("text/html");html?_onHTMLDrop(html):files.length?_onFilesDrop(files):_onDrop(event)}}function getDistanceToNearestEdge(point,rect,allowedEdges=["top","bottom","left","right"]){let candidateDistance,candidateEdge;return allowedEdges.forEach((edge=>{const distance=function getDistanceFromPointToEdge(point,rect,edge){const isHorizontal="top"===edge||"bottom"===edge,{x:x,y:y}=point,pointLateralPosition=isHorizontal?x:y,pointForwardPosition=isHorizontal?y:x,edgeStart=isHorizontal?rect.left:rect.top,edgeEnd=isHorizontal?rect.right:rect.bottom,edgeForwardPosition=rect[edge];let edgeLateralPosition;return edgeLateralPosition=pointLateralPosition>=edgeStart&&pointLateralPosition<=edgeEnd?pointLateralPosition:pointLateralPosition<edgeEnd?edgeStart:edgeEnd,Math.sqrt((pointLateralPosition-edgeLateralPosition)**2+(pointForwardPosition-edgeForwardPosition)**2)}(point,rect,edge);(void 0===candidateDistance||distance<candidateDistance)&&(candidateDistance=distance,candidateEdge=edge)})),[candidateDistance,candidateEdge]}const THRESHOLD_DISTANCE=30,MINIMUM_HEIGHT_FOR_THRESHOLD=120,MINIMUM_WIDTH_FOR_THRESHOLD=120;function isDropTargetValid(getBlockType,allowedBlocks,draggedBlockNames,targetBlockName){let areBlocksAllowed=!0;if(allowedBlocks){const allowedBlockNames=allowedBlocks?.map((({name:name})=>name));areBlocksAllowed=draggedBlockNames.every((name=>allowedBlockNames?.includes(name)))}const targetMatchesDraggedBlockParents=draggedBlockNames.map((name=>getBlockType(name))).every((block=>{const[allowedParentName]=block?.parent||[];return!allowedParentName||allowedParentName===targetBlockName}));return areBlocksAllowed&&targetMatchesDraggedBlockParents}function useBlockDropZone({dropZoneElement:dropZoneElement,rootClientId:targetRootClientId="",parentClientId:parentBlockClientId="",isDisabled:isDisabled=!1}={}){const registry=(0,use_registry.Z)(),[dropTarget,setDropTarget]=(0,react.useState)({index:null,operation:"insert"}),{getBlockType:getBlockType}=(0,use_select.Z)(blocks_build_module.h),{getBlockListSettings:getBlockListSettings,getBlocks:getBlocks,getBlockIndex:getBlockIndex,getDraggedBlockClientIds:getDraggedBlockClientIds,getBlockNamesByClientId:getBlockNamesByClientId,getAllowedBlocks:getAllowedBlocks}=(0,use_select.Z)(store.h),{showInsertionPoint:showInsertionPoint,hideInsertionPoint:hideInsertionPoint}=(0,use_dispatch.Z)(store.h),onBlockDrop=useOnBlockDrop("before"===dropTarget.operation||"after"===dropTarget.operation?parentBlockClientId:targetRootClientId,dropTarget.index,{operation:dropTarget.operation}),throttled=(0,use_throttle.Z)((0,react.useCallback)(((event,ownerDocument)=>{const allowedBlocks=getAllowedBlocks(targetRootClientId),targetBlockName=getBlockNamesByClientId([targetRootClientId])[0],draggedBlockNames=getBlockNamesByClientId(getDraggedBlockClientIds());if(!isDropTargetValid(getBlockType,allowedBlocks,draggedBlockNames,targetBlockName))return;const blocks=getBlocks(targetRootClientId);if(0===blocks.length)return void registry.batch((()=>{setDropTarget({index:0,operation:"insert"}),showInsertionPoint(targetRootClientId,0,{operation:"insert"})}));const blocksData=blocks.map((block=>{const clientId=block.clientId;return{isUnmodifiedDefaultBlock:(0,blocks_build_module.ZP)(block),getBoundingClientRect:()=>ownerDocument.getElementById(`block-${clientId}`).getBoundingClientRect(),blockIndex:getBlockIndex(clientId)}})),[targetIndex,operation]=function getDropTargetPosition(blocksData,position,orientation="vertical",options={}){const allowedEdges="horizontal"===orientation?["left","right"]:["top","bottom"];let nearestIndex=0,insertPosition="before",minDistance=1/0;const{dropZoneElement:dropZoneElement,parentBlockOrientation:parentBlockOrientation,rootBlockIndex:rootBlockIndex=0}=options;if(dropZoneElement&&"horizontal"!==parentBlockOrientation){const rect=dropZoneElement.getBoundingClientRect(),[distance,edge]=getDistanceToNearestEdge(position,rect,["top","bottom"]);if(rect.height>MINIMUM_HEIGHT_FOR_THRESHOLD&&distance<THRESHOLD_DISTANCE){if("top"===edge)return[rootBlockIndex,"before"];if("bottom"===edge)return[rootBlockIndex+1,"after"]}}const isRightToLeft=(0,build_module.dZ)();if(dropZoneElement&&"horizontal"===parentBlockOrientation){const rect=dropZoneElement.getBoundingClientRect(),[distance,edge]=getDistanceToNearestEdge(position,rect,["left","right"]);if(rect.width>MINIMUM_WIDTH_FOR_THRESHOLD&&distance<THRESHOLD_DISTANCE){if(isRightToLeft&&"right"===edge||!isRightToLeft&&"left"===edge)return[rootBlockIndex,"before"];if(isRightToLeft&&"left"===edge||!isRightToLeft&&"right"===edge)return[rootBlockIndex+1,"after"]}}blocksData.forEach((({isUnmodifiedDefaultBlock:isUnmodifiedDefaultBlock,getBoundingClientRect:getBoundingClientRect,blockIndex:blockIndex})=>{const rect=getBoundingClientRect();let[distance,edge]=getDistanceToNearestEdge(position,rect,allowedEdges);isUnmodifiedDefaultBlock&&function isPointContainedByRect(point,rect){return rect.left<=point.x&&rect.right>=point.x&&rect.top<=point.y&&rect.bottom>=point.y}(position,rect)&&(distance=0),distance<minDistance&&(insertPosition="bottom"===edge||!isRightToLeft&&"right"===edge||isRightToLeft&&"left"===edge?"after":"before",minDistance=distance,nearestIndex=blockIndex)}));const adjacentIndex=nearestIndex+("after"===insertPosition?1:-1),isNearestBlockUnmodifiedDefaultBlock=!!blocksData[nearestIndex]?.isUnmodifiedDefaultBlock,isAdjacentBlockUnmodifiedDefaultBlock=!!blocksData[adjacentIndex]?.isUnmodifiedDefaultBlock;if(!isNearestBlockUnmodifiedDefaultBlock&&!isAdjacentBlockUnmodifiedDefaultBlock)return["after"===insertPosition?nearestIndex+1:nearestIndex,"insert"];return[isNearestBlockUnmodifiedDefaultBlock?nearestIndex:adjacentIndex,"replace"]}(blocksData,{x:event.clientX,y:event.clientY},getBlockListSettings(targetRootClientId)?.orientation,{dropZoneElement:dropZoneElement,parentBlockClientId:parentBlockClientId,parentBlockOrientation:parentBlockClientId?getBlockListSettings(parentBlockClientId)?.orientation:void 0,rootBlockIndex:getBlockIndex(targetRootClientId)});registry.batch((()=>{setDropTarget({index:targetIndex,operation:operation});const insertionPointClientId=["before","after"].includes(operation)?parentBlockClientId:targetRootClientId;showInsertionPoint(insertionPointClientId,targetIndex,{operation:operation})}))}),[getAllowedBlocks,targetRootClientId,getBlockNamesByClientId,getDraggedBlockClientIds,getBlockType,getBlocks,getBlockListSettings,dropZoneElement,parentBlockClientId,getBlockIndex,registry,showInsertionPoint]),200);return(0,use_drop_zone.Z)({dropZoneElement:dropZoneElement,isDisabled:isDisabled,onDrop:onBlockDrop,onDragOver(event){throttled(event,event.currentTarget.ownerDocument)},onDragLeave(){throttled.cancel(),hideInsertionPoint()},onDragEnd(){throttled.cancel(),hideInsertionPoint()}})}},"./packages/block-editor/src/components/block-mover/stories/index.story.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:function(){return __namedExportsOrder},_default:function(){return _default},default:function(){return index_story}});var react=__webpack_require__("./node_modules/react/index.js"),build_module=__webpack_require__("./packages/blocks/build-module/index.js"),block_library_build_module=__webpack_require__("./packages/block-library/build-module/index.js"),use_dispatch=__webpack_require__("./packages/data/build-module/components/use-dispatch/use-dispatch.js"),toolbar=__webpack_require__("./packages/components/build-module/toolbar/toolbar/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),drag_handle=__webpack_require__("./packages/icons/build-module/library/drag-handle.js"),toolbar_group=__webpack_require__("./packages/components/build-module/toolbar/toolbar-group/index.js"),build_module_button=__webpack_require__("./packages/components/build-module/button/index.js"),toolbar_item=__webpack_require__("./packages/components/build-module/toolbar/toolbar-item/index.js"),use_select=__webpack_require__("./packages/data/build-module/components/use-select/index.js"),i18n_build_module=__webpack_require__("./packages/i18n/build-module/index.js"),draggable=__webpack_require__("./packages/components/build-module/draggable/index.js"),throttle=__webpack_require__("./packages/compose/build-module/utils/throttle/index.js"),draggable_chip=__webpack_require__("./packages/block-editor/src/components/block-draggable/draggable-chip.js"),get_scroll_container=__webpack_require__("./packages/dom/build-module/dom/get-scroll-container.js");var store=__webpack_require__("./packages/block-editor/src/store/index.js"),use_block_refs=__webpack_require__("./packages/block-editor/src/components/block-list/use-block-props/use-block-refs.js"),use_block_drop_zone=__webpack_require__("./packages/block-editor/src/components/use-block-drop-zone/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const BlockDraggable=({children:children,clientIds:clientIds,cloneClassname:cloneClassname,onDragStart:onDragStart,onDragEnd:onDragEnd,fadeWhenDisabled:fadeWhenDisabled=!1})=>{const{srcRootClientId:srcRootClientId,isDraggable:isDraggable,icon:icon,visibleInserter:visibleInserter,getBlockType:getBlockType}=(0,use_select.Z)((select=>{const{canMoveBlocks:canMoveBlocks,getBlockRootClientId:getBlockRootClientId,getBlockName:getBlockName,getBlockAttributes:getBlockAttributes,isBlockInsertionPointVisible:isBlockInsertionPointVisible}=select(store.h),{getBlockType:_getBlockType,getActiveBlockVariation:getActiveBlockVariation}=select(build_module.h),rootClientId=getBlockRootClientId(clientIds[0]),blockName=getBlockName(clientIds[0]),variation=getActiveBlockVariation(blockName,getBlockAttributes(clientIds[0]));return{srcRootClientId:rootClientId,isDraggable:canMoveBlocks(clientIds,rootClientId),icon:variation?.icon||_getBlockType(blockName)?.icon,visibleInserter:isBlockInsertionPointVisible(),getBlockType:_getBlockType}}),[clientIds]),isDragging=(0,react.useRef)(!1),[startScrolling,scrollOnDragOver,stopScrolling]=function useScrollWhenDragging(){const dragStartY=(0,react.useRef)(null),velocityY=(0,react.useRef)(null),scrollParentY=(0,react.useRef)(null),scrollEditorInterval=(0,react.useRef)(null);return(0,react.useEffect)((()=>()=>{scrollEditorInterval.current&&(clearInterval(scrollEditorInterval.current),scrollEditorInterval.current=null)}),[]),[(0,react.useCallback)((event=>{dragStartY.current=event.clientY,scrollParentY.current=(0,get_scroll_container.Z)(event.target),scrollEditorInterval.current=setInterval((()=>{if(scrollParentY.current&&velocityY.current){const newTop=scrollParentY.current.scrollTop+velocityY.current;scrollParentY.current.scroll({top:newTop})}}),25)}),[]),(0,react.useCallback)((event=>{if(!scrollParentY.current)return;const scrollParentHeight=scrollParentY.current.offsetHeight,offsetDragStartPosition=dragStartY.current-scrollParentY.current.offsetTop,offsetDragPosition=event.clientY-scrollParentY.current.offsetTop;if(event.clientY>offsetDragStartPosition){const moveableDistance=Math.max(scrollParentHeight-offsetDragStartPosition-50,0),dragDistance=Math.max(offsetDragPosition-offsetDragStartPosition-50,0),distancePercentage=0===moveableDistance||0===dragDistance?0:dragDistance/moveableDistance;velocityY.current=25*distancePercentage}else if(event.clientY<offsetDragStartPosition){const moveableDistance=Math.max(offsetDragStartPosition-50,0),dragDistance=Math.max(offsetDragStartPosition-offsetDragPosition-50,0),distancePercentage=0===moveableDistance||0===dragDistance?0:dragDistance/moveableDistance;velocityY.current=-25*distancePercentage}else velocityY.current=0}),[]),()=>{dragStartY.current=null,scrollParentY.current=null,scrollEditorInterval.current&&(clearInterval(scrollEditorInterval.current),scrollEditorInterval.current=null)}]}(),{getAllowedBlocks:getAllowedBlocks,getBlockNamesByClientId:getBlockNamesByClientId,getBlockRootClientId:getBlockRootClientId}=(0,use_select.Z)(store.h),{startDraggingBlocks:startDraggingBlocks,stopDraggingBlocks:stopDraggingBlocks}=(0,use_dispatch.Z)(store.h);(0,react.useEffect)((()=>()=>{isDragging.current&&stopDraggingBlocks()}),[]);const blockRef=(0,use_block_refs.tI)(clientIds[0]),editorRoot=blockRef.current?.closest("body");if((0,react.useEffect)((()=>{if(!editorRoot||!fadeWhenDisabled)return;const throttledOnDragOver=(0,throttle.P)((event=>{if(!event.target.closest("[data-block]"))return;const draggedBlockNames=getBlockNamesByClientId(clientIds),targetClientId=event.target.closest("[data-block]").getAttribute("data-block"),allowedBlocks=getAllowedBlocks(targetClientId),targetBlockName=getBlockNamesByClientId([targetClientId])[0];let dropTargetValid;if(0===allowedBlocks?.length){const targetRootClientId=getBlockRootClientId(targetClientId),targetRootBlockName=getBlockNamesByClientId([targetRootClientId])[0],rootAllowedBlocks=getAllowedBlocks(targetRootClientId);dropTargetValid=(0,use_block_drop_zone.wv)(getBlockType,rootAllowedBlocks,draggedBlockNames,targetRootBlockName)}else dropTargetValid=(0,use_block_drop_zone.wv)(getBlockType,allowedBlocks,draggedBlockNames,targetBlockName);dropTargetValid||visibleInserter?window?.document?.body?.classList?.remove("block-draggable-invalid-drag-token"):window?.document?.body?.classList?.add("block-draggable-invalid-drag-token")}),200);return editorRoot.addEventListener("dragover",throttledOnDragOver),()=>{editorRoot.removeEventListener("dragover",throttledOnDragOver)}}),[clientIds,editorRoot,fadeWhenDisabled,getAllowedBlocks,getBlockNamesByClientId,getBlockRootClientId,getBlockType,visibleInserter]),!isDraggable)return children({draggable:!1});const transferData={type:"block",srcClientIds:clientIds,srcRootClientId:srcRootClientId};return(0,jsx_runtime.jsx)(draggable.Z,{cloneClassname:cloneClassname,__experimentalTransferDataType:"wp-blocks",transferData:transferData,onDragStart:event=>{window.requestAnimationFrame((()=>{startDraggingBlocks(clientIds),isDragging.current=!0,startScrolling(event),onDragStart&&onDragStart()}))},onDragOver:scrollOnDragOver,onDragEnd:()=>{stopDraggingBlocks(),isDragging.current=!1,stopScrolling(),onDragEnd&&onDragEnd()},__experimentalDragComponent:(0,jsx_runtime.jsx)(draggable_chip.Z,{count:clientIds.length,icon:icon,fadeWhenDisabled:!0}),children:({onDraggableStart:onDraggableStart,onDraggableEnd:onDraggableEnd})=>children({draggable:!0,onDragStart:onDraggableStart,onDragEnd:onDraggableEnd})})};BlockDraggable.displayName="BlockDraggable",BlockDraggable.__docgenInfo={description:"",methods:[],displayName:"BlockDraggable",props:{fadeWhenDisabled:{defaultValue:{value:"false",computed:!1},required:!1}}};var block_draggable=BlockDraggable,component=__webpack_require__("./packages/components/build-module/visually-hidden/component.js"),use_instance_id=__webpack_require__("./packages/compose/build-module/hooks/use-instance-id/index.js"),chevron_right=__webpack_require__("./packages/icons/build-module/library/chevron-right.js"),chevron_left=__webpack_require__("./packages/icons/build-module/library/chevron-left.js"),chevron_up=__webpack_require__("./packages/icons/build-module/library/chevron-up.js"),chevron_down=__webpack_require__("./packages/icons/build-module/library/chevron-down.js");const getMovementDirection=(moveDirection,orientation)=>"up"===moveDirection?"horizontal"===orientation?(0,i18n_build_module.dZ)()?"right":"left":"up":"down"===moveDirection?"horizontal"===orientation?(0,i18n_build_module.dZ)()?"left":"right":"down":null;function getBlockMoverDescription(selectedCount,type,firstIndex,isFirst,isLast,dir,orientation){const position=firstIndex+1;if(selectedCount>1)return function getMultiBlockMoverDescription(selectedCount,firstIndex,isFirst,isLast,dir,orientation){const position=firstIndex+1;if(isFirst&&isLast)return(0,i18n_build_module.__)("All blocks are selected, and cannot be moved");if(dir>0&&!isLast){const movementDirection=getMovementDirection("down",orientation);if("down"===movementDirection)return(0,i18n_build_module.gB)((0,i18n_build_module.__)("Move %1$d blocks from position %2$d down by one place"),selectedCount,position);if("left"===movementDirection)return(0,i18n_build_module.gB)((0,i18n_build_module.__)("Move %1$d blocks from position %2$d left by one place"),selectedCount,position);if("right"===movementDirection)return(0,i18n_build_module.gB)((0,i18n_build_module.__)("Move %1$d blocks from position %2$d right by one place"),selectedCount,position)}if(dir>0&&isLast){const movementDirection=getMovementDirection("down",orientation);if("down"===movementDirection)return(0,i18n_build_module.__)("Blocks cannot be moved down as they are already at the bottom");if("left"===movementDirection)return(0,i18n_build_module.__)("Blocks cannot be moved left as they are already are at the leftmost position");if("right"===movementDirection)return(0,i18n_build_module.__)("Blocks cannot be moved right as they are already are at the rightmost position")}if(dir<0&&!isFirst){const movementDirection=getMovementDirection("up",orientation);if("up"===movementDirection)return(0,i18n_build_module.gB)((0,i18n_build_module.__)("Move %1$d blocks from position %2$d up by one place"),selectedCount,position);if("left"===movementDirection)return(0,i18n_build_module.gB)((0,i18n_build_module.__)("Move %1$d blocks from position %2$d left by one place"),selectedCount,position);if("right"===movementDirection)return(0,i18n_build_module.gB)((0,i18n_build_module.__)("Move %1$d blocks from position %2$d right by one place"),selectedCount,position)}if(dir<0&&isFirst){const movementDirection=getMovementDirection("up",orientation);if("up"===movementDirection)return(0,i18n_build_module.__)("Blocks cannot be moved up as they are already at the top");if("left"===movementDirection)return(0,i18n_build_module.__)("Blocks cannot be moved left as they are already are at the leftmost position");if("right"===movementDirection)return(0,i18n_build_module.__)("Blocks cannot be moved right as they are already are at the rightmost position")}}(selectedCount,firstIndex,isFirst,isLast,dir,orientation);if(isFirst&&isLast)return(0,i18n_build_module.gB)((0,i18n_build_module.__)("Block %s is the only block, and cannot be moved"),type);if(dir>0&&!isLast){const movementDirection=getMovementDirection("down",orientation);if("down"===movementDirection)return(0,i18n_build_module.gB)((0,i18n_build_module.__)("Move %1$s block from position %2$d down to position %3$d"),type,position,position+1);if("left"===movementDirection)return(0,i18n_build_module.gB)((0,i18n_build_module.__)("Move %1$s block from position %2$d left to position %3$d"),type,position,position+1);if("right"===movementDirection)return(0,i18n_build_module.gB)((0,i18n_build_module.__)("Move %1$s block from position %2$d right to position %3$d"),type,position,position+1)}if(dir>0&&isLast){const movementDirection=getMovementDirection("down",orientation);if("down"===movementDirection)return(0,i18n_build_module.gB)((0,i18n_build_module.__)("Block %1$s is at the end of the content and can’t be moved down"),type);if("left"===movementDirection)return(0,i18n_build_module.gB)((0,i18n_build_module.__)("Block %1$s is at the end of the content and can’t be moved left"),type);if("right"===movementDirection)return(0,i18n_build_module.gB)((0,i18n_build_module.__)("Block %1$s is at the end of the content and can’t be moved right"),type)}if(dir<0&&!isFirst){const movementDirection=getMovementDirection("up",orientation);if("up"===movementDirection)return(0,i18n_build_module.gB)((0,i18n_build_module.__)("Move %1$s block from position %2$d up to position %3$d"),type,position,position-1);if("left"===movementDirection)return(0,i18n_build_module.gB)((0,i18n_build_module.__)("Move %1$s block from position %2$d left to position %3$d"),type,position,position-1);if("right"===movementDirection)return(0,i18n_build_module.gB)((0,i18n_build_module.__)("Move %1$s block from position %2$d right to position %3$d"),type,position,position-1)}if(dir<0&&isFirst){const movementDirection=getMovementDirection("up",orientation);if("up"===movementDirection)return(0,i18n_build_module.gB)((0,i18n_build_module.__)("Block %1$s is at the beginning of the content and can’t be moved up"),type);if("left"===movementDirection)return(0,i18n_build_module.gB)((0,i18n_build_module.__)("Block %1$s is at the beginning of the content and can’t be moved left"),type);if("right"===movementDirection)return(0,i18n_build_module.gB)((0,i18n_build_module.__)("Block %1$s is at the beginning of the content and can’t be moved right"),type)}}const getArrowIcon=(direction,orientation)=>"up"===direction?"horizontal"===orientation?(0,i18n_build_module.dZ)()?chevron_right.Z:chevron_left.Z:chevron_up.Z:"down"===direction?"horizontal"===orientation?(0,i18n_build_module.dZ)()?chevron_left.Z:chevron_right.Z:chevron_down.Z:null,getMovementDirectionLabel=(moveDirection,orientation)=>"up"===moveDirection?"horizontal"===orientation?(0,i18n_build_module.dZ)()?(0,i18n_build_module.__)("Move right"):(0,i18n_build_module.__)("Move left"):(0,i18n_build_module.__)("Move up"):"down"===moveDirection?"horizontal"===orientation?(0,i18n_build_module.dZ)()?(0,i18n_build_module.__)("Move left"):(0,i18n_build_module.__)("Move right"):(0,i18n_build_module.__)("Move down"):null,BlockMoverButton=(0,react.forwardRef)((({clientIds:clientIds,direction:direction,orientation:moverOrientation,...props},ref)=>{const instanceId=(0,use_instance_id.Z)(BlockMoverButton),normalizedClientIds=Array.isArray(clientIds)?clientIds:[clientIds],blocksCount=normalizedClientIds.length,{blockType:blockType,isDisabled:isDisabled,rootClientId:rootClientId,isFirst:isFirst,isLast:isLast,firstIndex:firstIndex,orientation:orientation="vertical"}=(0,use_select.Z)((select=>{const{getBlockIndex:getBlockIndex,getBlockRootClientId:getBlockRootClientId,getBlockOrder:getBlockOrder,getBlock:getBlock,getBlockListSettings:getBlockListSettings}=select(store.h),firstClientId=normalizedClientIds[0],blockRootClientId=getBlockRootClientId(firstClientId),firstBlockIndex=getBlockIndex(firstClientId),lastBlockIndex=getBlockIndex(normalizedClientIds[normalizedClientIds.length-1]),blockOrder=getBlockOrder(blockRootClientId),block=getBlock(firstClientId),isFirstBlock=0===firstBlockIndex,isLastBlock=lastBlockIndex===blockOrder.length-1,{orientation:blockListOrientation}=getBlockListSettings(blockRootClientId)||{};return{blockType:block?(0,build_module.ck)(block.name):null,isDisabled:"up"===direction?isFirstBlock:isLastBlock,rootClientId:blockRootClientId,firstIndex:firstBlockIndex,isFirst:isFirstBlock,isLast:isLastBlock,orientation:moverOrientation||blockListOrientation}}),[clientIds,direction]),{moveBlocksDown:moveBlocksDown,moveBlocksUp:moveBlocksUp}=(0,use_dispatch.Z)(store.h),moverFunction="up"===direction?moveBlocksUp:moveBlocksDown,descriptionId=`block-editor-block-mover-button__description-${instanceId}`;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(build_module_button.ZP,{ref:ref,className:classnames_default()("block-editor-block-mover-button",`is-${direction}-button`),icon:getArrowIcon(direction,orientation),label:getMovementDirectionLabel(direction,orientation),"aria-describedby":descriptionId,...props,onClick:isDisabled?null:event=>{moverFunction(clientIds,rootClientId),props.onClick&&props.onClick(event)},disabled:isDisabled,__experimentalIsFocusable:!0}),(0,jsx_runtime.jsx)(component.Z,{id:descriptionId,children:getBlockMoverDescription(blocksCount,blockType&&blockType.title,firstIndex,isFirst,isLast,"up"===direction?-1:1,orientation)})]})})),BlockMoverUpButton=(0,react.forwardRef)(((props,ref)=>(0,jsx_runtime.jsx)(BlockMoverButton,{direction:"up",ref:ref,...props}))),BlockMoverDownButton=(0,react.forwardRef)(((props,ref)=>(0,jsx_runtime.jsx)(BlockMoverButton,{direction:"down",ref:ref,...props})));function BlockMover({clientIds:clientIds,hideDragHandle:hideDragHandle}){const{canMove:canMove,rootClientId:rootClientId,isFirst:isFirst,isLast:isLast,orientation:orientation}=(0,use_select.Z)((select=>{const{getBlockIndex:getBlockIndex,getBlockListSettings:getBlockListSettings,canMoveBlocks:canMoveBlocks,getBlockOrder:getBlockOrder,getBlockRootClientId:getBlockRootClientId}=select(store.h),normalizedClientIds=Array.isArray(clientIds)?clientIds:[clientIds],firstClientId=normalizedClientIds[0],_rootClientId=getBlockRootClientId(firstClientId),firstIndex=getBlockIndex(firstClientId),lastIndex=getBlockIndex(normalizedClientIds[normalizedClientIds.length-1]),blockOrder=getBlockOrder(_rootClientId);return{canMove:canMoveBlocks(clientIds,_rootClientId),rootClientId:_rootClientId,isFirst:0===firstIndex,isLast:lastIndex===blockOrder.length-1,orientation:getBlockListSettings(_rootClientId)?.orientation}}),[clientIds]);if(!canMove||isFirst&&isLast&&!rootClientId)return null;const dragHandleLabel=(0,i18n_build_module.__)("Drag");return(0,jsx_runtime.jsxs)(toolbar_group.Z,{className:classnames_default()("block-editor-block-mover",{"is-horizontal":"horizontal"===orientation}),children:[!hideDragHandle&&(0,jsx_runtime.jsx)(block_draggable,{clientIds:clientIds,fadeWhenDisabled:!0,children:draggableProps=>(0,jsx_runtime.jsx)(build_module_button.ZP,{icon:drag_handle.Z,className:"block-editor-block-mover__drag-handle","aria-hidden":"true",label:dragHandleLabel,tabIndex:"-1",...draggableProps})}),(0,jsx_runtime.jsxs)("div",{className:"block-editor-block-mover__move-button-container",children:[(0,jsx_runtime.jsx)(toolbar_item.Z,{children:itemProps=>(0,jsx_runtime.jsx)(BlockMoverUpButton,{clientIds:clientIds,...itemProps})}),(0,jsx_runtime.jsx)(toolbar_item.Z,{children:itemProps=>(0,jsx_runtime.jsx)(BlockMoverDownButton,{clientIds:clientIds,...itemProps})})]})]})}BlockMover.displayName="BlockMover",BlockMover.__docgenInfo={description:"",methods:[],displayName:"BlockMover"};var block_mover=BlockMover,provider=__webpack_require__("./packages/block-editor/src/components/provider/index.js");(0,block_library_build_module.Pr)();const blocks=[(0,build_module.j4)("core/group",{layout:{type:"flex"}},[(0,build_module.j4)("core/paragraph"),(0,build_module.j4)("core/paragraph"),(0,build_module.j4)("core/paragraph")]),(0,build_module.j4)("core/buttons",{},[(0,build_module.j4)("core/button"),(0,build_module.j4)("core/button"),(0,build_module.j4)("core/button")])];function Provider({children:children}){return(0,jsx_runtime.jsx)("div",{style:{margin:"24px",position:"relative"},children:(0,jsx_runtime.jsx)(provider.jC,{value:blocks,children:children})})}function BlockMoverStory(){const{updateBlockListSettings:updateBlockListSettings}=(0,use_dispatch.Z)(store.h);return(0,react.useEffect)((()=>{updateBlockListSettings(blocks[1].clientId,{orientation:"horizontal"})}),[]),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("p",{children:"The mover by default is vertical"}),(0,jsx_runtime.jsx)(toolbar.Z,{label:"Block Mover",children:(0,jsx_runtime.jsx)(block_mover,{clientIds:blocks.length?[blocks[0].innerBlocks[1].clientId]:[]})}),(0,jsx_runtime.jsx)("p",{style:{marginTop:36},children:"But it can also accommodate horizontal blocks."}),(0,jsx_runtime.jsx)(toolbar.Z,{label:"Block Mover",children:(0,jsx_runtime.jsx)(block_mover,{clientIds:blocks.length?[blocks[1].innerBlocks[1].clientId]:[]})}),(0,jsx_runtime.jsx)("p",{style:{marginTop:36},children:"We can also hide the drag handle."}),(0,jsx_runtime.jsx)(toolbar.Z,{label:"Block Mover",children:(0,jsx_runtime.jsx)(block_mover,{clientIds:blocks.length?[blocks[1].innerBlocks[0].clientId]:[],hideDragHandle:!0})})]})}Provider.displayName="Provider",BlockMoverStory.displayName="BlockMoverStory";var index_story={title:"BlockEditor/BlockMover",parameters:{sourceLink:"packages/block-editor/src/components/block-mover"}};const _default=()=>(0,jsx_runtime.jsx)(Provider,{children:(0,jsx_runtime.jsx)(BlockMoverStory,{})});_default.displayName="_default",_default.parameters={..._default.parameters,docs:{..._default.parameters?.docs,source:{originalSource:"() => {\n  return <Provider>\n            <BlockMoverStory />\n        </Provider>;\n}",..._default.parameters?.docs?.source}}};const __namedExportsOrder=["_default"];_default.__docgenInfo={description:"",methods:[],displayName:"_default"}}}]);